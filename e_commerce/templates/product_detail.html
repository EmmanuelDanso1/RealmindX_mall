<div class="mt-4">
  <h5>Ratings</h5>

  <!-- ‚≠ê Show average rating -->
  <p class="text-warning">
    ‚≠ê {{ product.average_rating }}/5
    <small>({{ product.ratings|length }} reviews)</small>
  </p>

  {% if current_user.is_authenticated %}
    {% if user_rating %}
      <!-- üö´ Already rated -->
      <p class="text-muted">You rated this product: ‚≠ê {{ user_rating.rating }}/5</p>
    {% else %}
      <!-- ‚úÖ Rating form -->
      <form method="POST" action="{{ url_for('main.rate_product', product_id=product.id) }}">
        <label for="rating">Rate this product:</label>
        <select name="rating" id="rating" class="form-select w-auto d-inline-block mx-2" required>
          <option value="">Choose</option>
          {% for i in range(1, 6) %}
          <option value="{{ i }}">{{ i }}</option>
          {% endfor %}
        </select>
        <button type="submit" class="btn btn-sm btn-primary">Submit</button>
      </form>
    {% endif %}
  {% else %}
  <!-- add authentication to login -->
    <p><a href="#">Log in</a> to rate this product.</p>
  {% endif %}
</div>
